# План звіту (≈20 сторінок) для AsterViz

Нижче наведено орієнтовний зміст звіту, поділений на **теоретичну** та **практичну** частини, з рекомендованим розподілом обсягу, і переліком ілюстрацій/таблиць для заповнення ~20 сторінок.

> Примітка: кількість сторінок залежить від вимог кафедри (шрифт/міжряддя/поля). У плані закладено запас через ілюстрації та таблиці.

## Орієнтовний розподіл обсягу (20 стор.)

| Розділ | Орієнтовно, стор. |
|---|---:|
| Вступ | 1 |
| **1. Теоретична частина** | 8 |
| **2. Практична частина** | 9 |
| Висновки | 1 |
| Список джерел | 1 |
| **Разом** | **20** |

---

## Вступ (≈1 стор.)

- Актуальність теми: вебвізуалізація астрономічних даних, навчальні/прикладні сценарії.
- Мета роботи: створення вебзастосунку для 3D-візуалізації Сонячної системи та малих тіл.
- Завдання (5–7 пунктів): аналіз технологій, проєктування UI/UX, реалізація API, реалізація 3D-сцени, оптимізація продуктивності, тестування.
- Об’єкт/предмет: вебвізуалізація орбітальних даних; взаємодія користувача з 3D-сценою.
- Коротко про структуру роботи (теорія + практика).

Рекомендована ілюстрація:
- Рис. 1 — загальна схема «Користувач → UI → API → дані → 3D-сцена».

---

# 1. Теоретична частина (≈8 стор.)

## 1.1. Вебвізуалізація наукових даних: поняття та вимоги (≈1 стор.)

- Візуалізація як спосіб інтерпретації даних: читабельність, точність, відтворюваність.
- Вимоги до вебвізуалізацій: інтерактивність, кросплатформність, продуктивність.
- Типові прийоми взаємодії: zoom/pan/hover, фільтри, режими перегляду.

Рекомендовані матеріали:
- Коротка таблиця «потреба → UI-інструмент» (напр., «порівняння → Compare mode»).

## 1.2. Астрономічний контекст: малі тіла Сонячної системи (≈1 стор.)

- Класи малих тіл: головний пояс астероїдів (Main-belt), навколоземні (NEO), троянці (Trojans), комети (Comets).
- Які задачі вирішує візуалізація: демонстрація орбіт, порівняння параметрів, інтуїтивне розуміння нахилу/ексцентриситету.

Рекомендована ілюстрація:
- Рис. 2 — схематичне розміщення категорій у Сонячній системі (необов’язково точне, навчальне).

## 1.3. Орбітальні елементи та їх інтерпретація (≈1.5 стор.)

- Перелік параметрів (з вашої моделі/датасету): `a, e, i, Ω, ω, M0, epoch`, додатково `H, q, Q, period`.
- Пояснення фізичного змісту:
  - `a` — велика піввісь (масштаб орбіти),
  - `e` — ексцентриситет (витягнутість),
  - `i` — нахил орбіти,
  - `Ω, ω` — орієнтація орбіти в просторі,
  - `M0` і `epoch` — положення тіла на орбіті у вибраний момент.

Рекомендовані матеріали:
- Табл. 1 — «Параметр → одиниці/діапазони → вплив на вигляд орбіти».

## 1.4. Математична основа: рівняння Кеплера та отримання положення (≈2 стор.)

- Рівняння Кеплера (коротко): зв’язок середньої аномалії `M`, ексцентричної `E` та ексцентриситету `e`.
- Ітераційний розв’язок (Newton–Raphson): ідея, критерій зупинки, стабільність.
- Перехід координат:
  - періфокальна система → інерціальна (повороти через `ω`, `i`, `Ω`),
  - узгодження з осями 3D-сцени (візуальна система координат).
- Час: використання Julian Day, роль `epoch`.

Рекомендовані ілюстрації:
- Рис. 3 — схема систем координат (площина орбіти та нахил).
- Формула 1 — рівняння Кеплера (в тексті).
- Формула 2 — зв’язок періоду з `a` (як підвід до Kepler Lab/3-го закону).

## 1.5. Вебдизайн та UI/UX для астрономічної 3D-візуалізації (≈1.5 стор.)

- Інформаційна ієрархія: 3D-сцена як основний фокус + sidebar як керування.
- Режимність інтерфейсу: окремі режими під різні сценарії (`Explore`, `Random`, `Compare`, `Search`, `Kepler Lab`).
- Пояснювальні елементи: tooltip, HUD-картка об’єкта, підписи/лейбли.
- Керування камерою: зум/обертання/супровід вибраного об’єкта.

Рекомендована ілюстрація:
- Рис. 4 — макет/скріншот головного екрану з підписами ключових зон (sidebar/canvas/HUD).

## 1.6. Кольорова система та візуальна мова «під астрономію» (≈1 стор.)

- Темна тема як базовий фон (асоціація з небом) + вимоги контрастності.
- Семантичне кодування кольором категорій (приклад: Main-belt/NEO/Trojan/Comet).
- Ризики: надмірні ефекти (glow/bloom) та можливе спотворення сприйняття; баланс естетики й точності.
- Доступність: контраст, розрізнення кольорів, варіанти для дальтонізму (описово).

Рекомендовані матеріали:
- Табл. 2 — «Категорія → колір → призначення (UI/3D)».

---

# 2. Практична частина (≈9 стор.)

## 2.1. Вимоги до системи та сценарії використання (≈1 стор.)

- Функціональні вимоги:
  - відображення планет/орбіт/малих тіл,
  - вибір об'єкта, підказки, HUD,
  - фільтрація шарами, зміна кількості об'єктів (1k/5k/20k),
  - режими `Explore/Random/Compare/Search/Kepler Lab`,
  - керування часом (play/pause, масштаб швидкості, scrub).
- Нефункціональні: швидкодія (FPS), стабільність, зручність, кросбраузерність.
- Модель користувача:
  - Цільова аудиторія: студенти/викладачі, любителі астрономії, користувачі, які вивчають орбітальні параметри.
  - Сценарії: швидкий пошук об'єкта, порівняння орбіт, демонстрація законів Кеплера, огляд класифікацій малих тіл.
  - Pain points: складність навігації між шарами, довгий шлях до потрібного об'єкта, втрата контексту при зміні масштабу, візуальне перевантаження.
- Критерії якості інтерфейсу: швидкість пошуку, зрозумілість шарів, відсутність перевантаження.

Рекомендовані матеріали:
- Табл. 3 — «Вимога → реалізаційний модуль → критерій перевірки».

## 2.2. Архітектура застосунку та взаємодія компонентів (≈1.5 стор.)

- Загальна схема:
  - Backend: Django + DRF, API-ендпоїнти, БД.
  - Frontend: ES-modules, Three.js сцена, UI-стан, i18n.
- Потоки даних:
  - Explore: отримання вибірки об'єктів -> побудова поля точок/ліній.
  - Random/Search: запит -> деталі -> фокус/супровід.
  - Ephemeris: часовий ряд -> відображення траєкторії/точок (за потреби).
- Елементи керування та меню (UI):
  - Sidebar-меню з режимами: `Explore`, `Random`, `Search`, `Compare`, `Kepler Lab`.
  - Блоки керування сценою: шари (planets/orbits/asteroids/overlays), перемикач стилю астероїдів (`Points`/`LineSegments`), фільтри/ліміти кількості об’єктів.
  - Керування часом: play/pause, швидкість, “scrub” часу для демонстрацій (зокрема у `Kepler Lab`).
  - HUD/tooltip: інфо про вибраний об’єкт, підказки гарячих клавіш, індикатори стану (завантаження, помилки).
  - Локалізація `UA|EN`: перемикач мови + словники у фронтенді.
- Рушій рендерингу (движок “малювання”):
  - `Three.js` поверх `WebGLRenderer`: камера/контроли, сцена, освітлення, постобробка (напр. bloom).
  - Геометрії для продуктивності: `BufferGeometry`, астероїди як `Points` (швидко) або `LineSegments` (орбіти/траєкторії).
  - Взаємодія: raycasting для hover/кліку, режим “follow selected”, масштабування та панорамування.
- Дані та БД:
  - `SQLite` (файл `db.sqlite3`) як локальна БД для прототипу; моделі на Django ORM для малих тіл/категорій.
  - Імпорт/оновлення каталогу (CSV/скрипти) та нормалізація полів (ідентифікатори, орбітальні елементи, класифікації).
  - API повертає оптимізовані JSON-відповіді (пагінація/ліміти/агрегації), щоб не перевантажувати фронтенд.
- Інші технології та інфраструктура:
  - `django-cors-headers` для коректних запитів з фронтенду.
  - Статичні ресурси: `templates/index.html` + `static/app/*` (ES modules), локальний `static/vendor/three/*`.
  - В продакшені (за потреби): `gunicorn`/`uvicorn` + `nginx`, міграція БД на `PostgreSQL`, кешування (напр. `Redis`) для важких запитів.

Рекомендовані ілюстрації:
- Рис. 5 — діаграма компонентів (Backend/API/Frontend/Three.js).
- (Опціонально) Рис. 5.1 — карта меню та станів UI (режими, панелі, шари, час).
- (Опціонально) Рис. 5.2 — схема рендерингу (UI -> state -> Three.js scene -> WebGL).

Промпт для генерації картинки (діаграми архітектури):
```text
Створи чисту векторну інфографіку “Архітектура вебзастосунку AsterViz”. Світлий фон, мінімалістичний flat-design, тонкі лінії, акуратні стрілки. 5 блоків з українськими підписами:
1) “Користувач / Браузер”
2) “Frontend (HTML/CSS/JS, ES modules, i18n, UI-стан, меню: Explore/Random/Search/Compare/Kepler Lab)”
3) “3D Рендеринг (Three.js + WebGLRenderer, сцена, камера, raycasting, Points/LineSegments, bloom)”
4) “Backend (Django + DRF, REST API, CORS)”
5) “База даних (SQLite db.sqlite3, ORM-моделі)”
Додай збоку блок “Джерела даних (CSV/каталоги, за потреби NASA/JPL)” зі стрілкою в Backend.
Покажи потік: Користувач -> Frontend -> 3D Рендеринг; Frontend <-> Backend (HTTP JSON); Backend <-> База даних (SQL/ORM). Стиль: сучасний, читабельний, формат 16:9, висока роздільна здатність.
```

## 2.3. Проєктування та реалізація бази даних (≈1 стор.)

- Сутність `SmallBody`: ключові поля, індекси, категорії.
- Причини вибору SQLite для локального прототипу/демо.
- Узгодження формату даних із CSV та API.

Рекомендовані матеріали:
- Рис. 6 — ER-діаграма/структура таблиці `SmallBody` (можна у вигляді таблиці полів).

## 2.4. Реалізація backend: REST API (≈1.5 стор.)

- Опис ендпоїнтів:
  - `GET /api/explore/` (вибірка для сцени),
  - `GET /api/random/`,
  - `GET /api/search/`,
  - `GET /api/object/<id>/`,
  - `GET /api/object/<id>/ephemeris/`,
  - `GET /api/stats/`.
- Формат відповідей (JSON), обробка помилок (400/404), обмеження (limit, max_points).

Рекомендовані матеріали:
- Табл. 4 — «Ендпоїнт → параметри → відповідь → призначення в UI».

## 2.5. Реалізація frontend: UI-стан, режими та локалізація (≈1.5 стор.)

- Організація інтерфейсу: sidebar (режими, шари, вибірка, час) + canvas (3D).
- Модульність режимів:
  - `Explore` — вибірка, кліки/вибір,
  - `Random` — випадковий об’єкт,
  - `Search` — пошук астероїдів і фокусування,
  - `Compare` — порівняння категорій/параметрів (описати ваш алгоритм),
  - `Kepler Lab` — демонстрація законів Кеплера (орбіта, фокуси, площі/графік).
- Локалізація `UA|EN`: структура словника, перемикання.

Рекомендовані ілюстрації:
- Рис. 7 — скріншоти 2–3 режимів (мінімум Explore + Kepler Lab).

## 2.6. Three.js сцена: побудова, шари, взаємодія (≈1.5 стор.)

- Основні об’єкти сцени: планети, орбіти планет, зоряне тло, поле малих тіл.
- Способи відображення великої кількості тіл:
  - `Points` (точки) для продуктивності,
  - `LineSegments`/лінії для альтернативного режиму.
- Взаємодія:
  - raycasting (вибір/hover),
  - follow selected, free fly,
  - box zoom (виділення прямокутником),
  - HUD/tooltip.
- Постобробка: bloom як візуальний акцент (обґрунтувати обережне використання).

**Текст для звіту (приклад опису реалізації 3D-візуалізації у Three.js)**  
3D-візуалізація реалізована у браузері за допомогою бібліотеки `Three.js`, яка надає зручний високорівневий API над `WebGL`. На етапі ініціалізації створюється `Scene`, камера (`PerspectiveCamera`) та рендерер `WebGLRenderer`. Для коректного відображення на різних екранах налаштовано `setPixelRatio(window.devicePixelRatio)`, а також обробник `resize`, який синхронізує `camera.aspect` і розмір canvas. Для стабільного відтворення кольорів використано лінійний рендеринг: текстури інтерпретуються у просторі `sRGB`, а вивід на екран виконується з коректним перетворенням кольору.

Сцену поділено на логічні шари: (1) центральне джерело світла (Сонце), (2) планети та їхні орбіти, (3) поле малих тіл (астероїди/комети), (4) допоміжні оверлеї для підписів та підказок. Планети відображаються як сферичні меші з `MeshStandardMaterial` (за потреби — з текстурами), а орбіти — як полілінії (`Line`/`LineLoop`), побудовані з набору точок, обчислених з орбітальних елементів. Для відображення тисяч об’єктів застосовано `THREE.Points` з `BufferGeometry` (координати у `Float32Array`), що зменшує навантаження на CPU та кількість draw calls і дозволяє підтримувати придатну продуктивність у реальному часі.

Дані надходять з backend API у форматі JSON (орбітальні елементи та довідкові параметри). На стороні клієнта положення кожного тіла обчислюється для вибраного моменту часу: розв’язується рівняння Кеплера (перехід від середньої аномалії `M` до ексцентричної `E`), далі отримуються координати у періфокальній системі та виконується перетворення в геліоцентричну систему координат поворотами на кути орієнтації орбіти. Оновлення стану сцени відбувається в анімаційному циклі `requestAnimationFrame`, а керування часом (play/pause, швидкість) змінює параметр симуляції та, відповідно, положення об’єктів.

Взаємодія користувача з 3D-сценою включає керування камерою (обертання/зум/панорамування через `OrbitControls`) та вибір об’єктів за допомогою `Raycaster`. Координати курсора перетворюються у нормалізовані екранні координати, після чого виконується перетин променя з доступними для вибору об’єктами. У разі наведення/кліку відображається `tooltip/HUD` з основними характеристиками (назва, клас, `a/e/i`, період тощо), а також може активуватися режим супроводу вибраного об’єкта.

Освітлення побудовано навколо моделі точкового джерела в центрі сцени (Сонця). Якісний вплив відстані на освітленість враховується законом обернених квадратів: при збільшенні відстані інтенсивність освітлення, що досягає поверхні об’єкта, спадає приблизно як `1/r^2`. У `Three.js` це відповідає фізично коректному затуханню (`decay = 2`) для `PointLight`; за потреби додатково застосовується масштабування яскравості для навчальної наочності (без претензії на фотометричну точність).

Для покращення сприйняття сцени використано обмежену постобробку через `EffectComposer` (наприклад, `UnrealBloomPass`) як акцент для найяскравіших об’єктів, щоб не перевантажувати зображення. Окремо враховано продуктивність: використання `BufferGeometry`, обмеження об’єктів у raycasting, зменшення деталізації на далеких масштабах (LOD) та оптимізація оновлень у циклі анімації.

Рекомендовані матеріали:
- Рис. 8 — схема шарів сцени (planets/orbits/asteroids/overlays).

## 2.7. Вибірка даних (5 000 астероїдів)

Вибірка: 5 000 астероїдів.

---

## 2.8. Результати тестування (Solar System Lab)

- Які проблеми знайшли:
  - пошук у великих вибірках сприймався повільним,
  - перемикачі шарів були неочевидними для нових користувачів,
  - підписи та орбіти одночасно створювали перевантаження сцени,
  - керування часом (scrub) вимагало підказок.
- Що саме змінили:
  - підсилили помітність поля пошуку та додали підказки вводу,
  - перегрупували шари й додали короткі пояснення,
  - обмежили кількість одночасних підписів/орбіт за замовчуванням,
  - додали підказки для scrub та режиму `Kepler Lab`.

---

## Висновки (≈1 стор.)

- Узагальнення результатів: реалізований backend+frontend, режими, орбіти, керування часом, продуктивність.
- Що підтверджено/досягнуто відповідно до задач.
- Можливі напрямки розвитку:
  - реальні ефемериди (JPL), точні планетні орбіти,
  - додаткові параметри/фільтри,
  - профілювання та подальші оптимізації, WebWorker/instancing,
  - розширення аналітики в Compare.

## Список джерел (≈1 стор.)

Рекомендовано 10–20 позицій:
- документація Django/DRF,
- документація Three.js,
- базові джерела з небесної механіки/орбітальних елементів,
- джерела даних NASA/JPL (опис формату/каталогів),
- джерела з принципів data visualization / UI для наукових застосунків.

---

## Додатки (за потреби, якщо дозволено вимогами)

- Додаток А - фрагменти структури API-відповідей (JSON приклади).
- Додаток Б - таблиця полів CSV та мапінг у модель БД.
- Додаток В - додаткові скріншоти режимів (Explore/Random/Search/Compare).

---

## План розділу: теорія з астрономії (≈2.5 стор.)

> Призначення: пояснити астрономічні поняття/моделі, які використовуються у вебзастосунку Solar System Lab (візуалізація орбіт, рух у часі, координати, освітлення).

### 1) Вступ до розділу (≈0.2 стор.)

- Чому для “Solar System Lab” потрібна астрономічна теорія: інтерпретація орбіт, коректність руху, зрозуміла візуальна модель.
- Які спрощення приймаються в навчальній симуляції (без збурень, без прецесії тощо) та що це означає для точності.

### 2) Масштаби й одиниці Сонячної системи (≈0.3 стор.)

- Базові одиниці: астрономічна одиниця (AU) для відстаней, кілометри (км) для довідкових величин, радіуси планет (R) для порівняння розмірів, роки/доба для періодів і кроку часу.
- Ключові перетворення (за потреби): `1 AU = 149 597 870.7 км`, `1 доба = 86 400 с`, `1 рік ≈ 365.25 доби`.
- Узгодження з даними/движком: які одиниці використовуються у датасеті, які — у внутрішній симуляції (напр., координати в AU, час у добах).
- Масштабування у візуалізації: чому відстані й розміри не можна показати "1:1", які компроміси застосовуються (окремі масштаби для радіусів та орбіт).

### 3) Небесна механіка: причини та закони орбітального руху (≈0.7 стор.)

- Закон всесвітнього тяжіння Ньютона: будь-які два тіла з масами притягуються; сила напрямлена вздовж лінії, що сполучає їхні центри мас, і спадає обернено пропорційно квадрату відстані.
  - Формула (модуль): `F = G * (m1*m2) / r^2`, де `G` — гравітаційна стала, `r` — відстань між центрами мас.
  - Векторно: `\vec F_{12} = -G * (m1*m2) / r^3 * \vec r_{12}` (мінус означає притягання).
  - Для «пробної» маси біля тіла маси `M`: `a = F/m = GM/r^2` (не залежить від `m`).
- Зв’язок сили та прискорення (2-й закон Ньютона): `\sum \vec F = m\vec a`, тобто `\vec a = (\sum \vec F)/m`.
- Закони Кеплера:
  - 1-й закон: еліптичність орбіт (перигелій/афелій),
  - 2-й закон: рівні площі (зміна швидкості на різних ділянках орбіти),
  - 3-й закон: залежність періоду обертання від великої півосі (як теоретична основа “Kepler Lab”).

У програмі AsterViz (режим `Kepler Lab`) 2-й закон Кеплера показано через однакові за площею сектори, що “вимітаються” радіус-вектором за рівні проміжки часу. Коли користувач змінює час (play/pause або “scrub”), видно, що поблизу перигелію тіло проходить більшу дугу за той самий інтервал, ніж біля афелію. Це підкреслює нерівномірність орбітальної швидкості та дає інтуїтивне пояснення закону рівних площ без складних формул.

### 4) Орбітальні елементи та обчислення положення в часі (≈0.6 стор.)

- Орбітальні елементи та їх сенс (як у вебзастосунку):
  - `a` — велика піввісь еліпса (semi-major axis), в AU.
  - `e` — ексцентриситет (0 — коло, 0<e<1 — еліпс), безрозмірний.
  - `i` — нахил орбіти до площини екліптики, у градусах.
  - `Ω` — довгота висхідного вузла (longitude of ascending node): кут у площині екліптики від осі відліку до лінії вузлів, у градусах.
  - `ω` — аргумент перигелію (argument of periapsis): кут у площині орбіти від висхідного вузла до перигелію, у градусах.
  - `epoch` — дата епохи (UTC, `YYYY-MM-DD`), з якої обчислюється `epochJD` (Julian Day) і далі час береться як зсув від епохи.


### 5) Координатні системи та перетворення для 3D-сцени (≈0.4 стор.)

- Геліоцентрична система та площина екліптики; нахил орбіти як відхилення від екліптики.
- Перетворення координат: від площини орбіти (періфокальна система) до інерціальної/геліоцентричної; узгодження з осями 3D-сцени.

### 6) Освітлення та спостережні ефекти (≈0.3 стор.)

- Закон обернених квадратів для освітленості (якісно): вплив відстані до Сонця на “яскравість” у моделі; на сайті — повзунок відстані `r` (AU) + показ `Irel = 1 / r²` та 3D “probe”-сфера на відстані `r`, яка стає тьмянішою зі зростанням `r` (наприклад: `r=1` → `1×`, `r=2` → `0.25×`).
- Фази (на прикладі Місяця/внутрішніх планет): геометрія “Сонце–тіло–спостерігач”, термінатор.
- За потреби (1 абзац): тінь/півтінь і умови затемнень/транзитів.

Рекомендовані ілюстрації/таблиці для розділу:
- Рис. X - схема елементів орбіти (еліпс + `a`, `e`, перигелій/афелій, кути `i, Ω, ω`).
- Рис. Y - ілюстрація 2-го закону Кеплера (рівні площі/сектори за однаковий час).
- Рис. Z - схема фаз (освітлена частина диска).
- Табл. X - <поняття → де використано в Solar System Lab → де відображено в UI>.
